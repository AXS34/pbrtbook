\section{场景定义}\label{sec:场景定义}

\subsection{世界端和渲染}\label{sub:世界端和渲染}
\begin{lstlisting}
`\refcode{API Function Definitions}{+=}\lastnext{APIFunctionDefinitions}`
void `\initvar{pbrtWorldEnd}{()}` {
    VERIFY_WORLD("WorldEnd");
    `\refcode{Ensure there are no pushed graphics states}{}`
    `\refcode{Create scene and render}{}`
    `\refcode{Clean up after rendering}{}`
}
\end{lstlisting}

\begin{lstlisting}
`\refcode{API Function Definitions}{+=}\lastcode{APIFunctionDefinitions}`
`\refvar{Scene}{}` *`\refvar{RenderOptions}{}`::`\initvar[RenderOptions::MakeScene]{MakeScene}{()}` {
    std::shared_ptr<`\refvar{Primitive}{}`> accelerator =
        MakeAccelerator(AcceleratorName, primitives, AcceleratorParams);
    if (!accelerator)
        accelerator = std::make_shared<`\refvar{BVHAccel}{}`>(primitives);
    `\refvar{Scene}{}` *scene = new `\refvar{Scene}{}`(accelerator, lights);
    `\refcode{Erase primitives and lights from RenderOptions}{}`
    return scene;
}
\end{lstlisting}

\begin{lstlisting}
`\initcode{RenderOptions Public Methods}{=}` 
`\refvar{Integrator}{}` *`\initvar[RenderOptions::MakeIntegrator]{MakeIntegrator}{()}` const;
\end{lstlisting}